<!DOCTYPE>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Beartec - Home</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/reset.css" />
    <link rel="stylesheet" type="text/css" href="stylesheets/main.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>

<body class="container">
    <div id="header">
        <div class="custom_navbar">

            <a id="brand" href="index.html">
                <img src="logo.png" height="30px" class="d-inline-block align-top">
                BearTec
            </a>
            <ul id="main_menu">
                <li class="first_list"><a href="index.html" class="main_menu_first main_current">home</a></li>
                <li class="first_list"><a href="https://beartec.azurewebsites.net/" class="main_menu_first">blog</a>
                </li>
            </ul>
        </div> <!-- END .container -->
    </div> <!-- END #header -->

    <div id="main_content">
        <div id="slideshow_area">
            <div class="container">
                <div id="slideshow_container" class="flex-centered-items-container">
                    <img src="images/banner1.png" alt="banner1" />
                </div> <!-- END #slideshow_container -->
            </div> <!-- END .container -->
        </div> <!-- END #slideshow_area -->

        <!-- articles here-->
        <h5 class="mt-2">Lee nuestro blog</h5>
        <hr>
        <section class="d-flex flex-wrap mb-2 justify-content-between" id="blog-entries-container">
            <div class="d-flex justify-content-center w-100">
                <div class="spinner-grow" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
                <div class="spinner-grow" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
                <div class="spinner-grow" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
            
        </section>


        <div id="footer">

            <div class="footer_info">

                <h4>about us</h4>
                <p>Grupo de estudiantes de ingenieria apasionados por la tecnologia y el desarrollo de la misma. </p>

            </div> <!-- END #footer_about -->

            <div class="footer_info">
                <h4>explore</h4>
                <ul>
                    <li><a href="index.html">home</a></li>
                    <li><a href="https://beartec.azurewebsites.net/">blog</a></li>
                </ul>
            </div> <!-- END #footer_about -->


            <div class="footer_info">
                <h4>connect with us</h4>
                <a href="https://www.facebook.com/BearTec-109737720692447" id="facebook" title="Facebook">
                    <img src="images/facebook_icon.png">
                </a>

            </div> <!-- END #footer -->
            <script src="javascript/styling.js"></script>
            <script>
                // erik cavazos, last modified 02/10/2020
                // script to get up to 4 most recent articles from the blog and insert them in the page
                onload = getLastArticles();
                class Article {
                    name;
                    description;
                    link;
                    constructor(name, description, link){
                        this.name = name;
                        this.description = description;
                        this.link = link;
                    }
                    get name() {
                        return this.name;
                    }
                    get description() {
                        return this.description;
                    }
                    get link(){
                        return this.link;
                    }
                }
                function getLastArticles() {
                    const lastArticlesURL = "https://beartec.azurewebsites.net/api/GetLastArticles";
                    const http = new XMLHttpRequest();

                    http.open("GET", lastArticlesURL);
                    http.timeout = 20000; // 20s
                    http.onreadystatechange = function () {
                        if (this.readyState === 4 && this.status === 200) {
                            var jsonResponse = JSON.parse(this.responseText);
                            var blogEntriesContainer = document.getElementById("blog-entries-container");
                            blogEntriesContainer.innerHTML = "";
                            for (i = 0; i < jsonResponse.length; i++) {
                                var articulo = new Article(
                                    jsonResponse[i].titulo,
                                    jsonResponse[i].descripcion,
                                    jsonResponse[i].link
                                );
                                
                                console.log("Titulo: " + articulo.name);
                                console.log("Descripcion: " + articulo.description);
                                console.log("Link: " + articulo.link);
                                /*
                                make this with js
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Special title treatment</h5>
                                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                                        <a href="#" class="btn btn-primary">Go somewhere</a>
                                    </div>
                                </div>
                                */
                                // create empty div for card
                                var cardElement = document.createElement("div");
                                cardElement.classList.add("card");
                                cardElement.classList.add("custom-card-blog-entry");
                                
                                // create empty div for card-body
                                var cardBodyElement = document.createElement("div");
                                cardBodyElement.classList.add("card-body");

                                // create h5 for title that goes into card-body
                                var h5Element = document.createElement("h5");
                                h5Element.classList.add("card-title");

                                // create p element that goes into card-body
                                var pElement = document.createElement("p");
                                pElement.classList.add("card-text");

                                // create a element that goes into card-body
                                var aElement = document.createElement("a");
                                aElement.classList.add("m-3");

                                // fill in h5, p and a
                                h5Element.innerText = articulo.name;
                                pElement.innerText = articulo.description;
                                aElement.innerText = "Leer m√°s";
                                aElement.setAttribute("href",articulo.link);

                                // put h5, p and a into card-body
                                cardBodyElement.appendChild(h5Element);
                                cardBodyElement.appendChild(pElement);
                                cardBodyElement.appendChild(aElement);

                                // put resultant card-body into card
                                cardElement.appendChild(cardBodyElement);

                                // put card into container
                                
                                blogEntriesContainer.appendChild(cardElement);
                            }
                        }
                    }
                    http.send();
                }
            </script>
</body>

</html>
